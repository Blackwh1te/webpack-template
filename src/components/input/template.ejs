<%
const defaults = require('./data.json').data
const params = (typeof data === 'undefined') ? defaults : {...defaults, ...data}
const {
  extraClasses,
  extraAttrs,
  name,
  type,
  label,
  value,
  placeholder,
  required,
  disabled,
  readonly,
  isShowError,
  maxlength,
  tabindex,
  inputMode,
  form,
  autocomplete,
  wrapperExtraClasses,
  hasPasswordEye,
} = params
%>

<%
  let wrapperClasses = 'form-input-wrapper'
  if (wrapperExtraClasses) wrapperClasses += ` ${wrapperExtraClasses}`

  let wrapperAttrs = ''
  if (hasPasswordEye) wrapperAttrs += ' data-js-password'

  let labelClasses = 'form-label'
  if (label.isHidden) labelClasses += ' visually-hidden'

  let inputClasses = 'form-input'
  if (extraClasses) inputClasses += ` ${extraClasses}`
  if (hasPasswordEye) inputClasses += ' form-input--has-btn'

  let inputAttrs = ''
  if (hasPasswordEye) inputAttrs += ' data-js-password-input'
%>

<label class="form-item">
  <span
    class="<%= wrapperClasses %>"
    data-js-input-wrapper
    <%- wrapperAttrs %>
  >
    <% if (type === 'textarea') { %>
      <textarea
        class="<%= inputClasses %>"
        id="<%= name %>"
        name="<%= name %>"

        <% if (placeholder) { %>
          placeholder="<%= placeholder %>"
        <% } %>

        <% if (tabindex) { %>
          tabindex="<%= tabindex %>"
        <% } %>

        <% if (inputMode) { %>
          inputMode="<%= inputMode %>"
        <% } %>

        <% if (maxlength) { %>
          maxlength="<%= maxlength %>"
        <% } %>

        <% if (required) { %>
          data-js-input-required="<%= required %>"
          required
        <% } %>

        <% if (disabled) { %>
          disabled
        <% } %>

        <% if (readonly) { %>
          readonly
        <% } %>

        <% if (form) { %>
          form="<%= form %>"
        <% } %>

        <%- extraAttrs %>
      >
        <% if (value) { %>
          <%= value %>
        <% } %>
      </textarea>
    <% } else { %>
      <input
        class="<%= inputClasses %>"
        id="<%= name %>"
        name="<%= name %>"
        type="<%= type %>"

        <% if (value) { %>
          value="<%= value %>"
        <% } %>

        <% if (placeholder) { %>
          placeholder="<%= placeholder %>"
        <% } %>

        <% if (required) { %>
          data-js-input-required="<%= required %>"
          required
        <% } %>

        <% if (disabled) { %>
          disabled
        <% } %>

        <% if (readonly) { %>
          readonly
        <% } %>

        <% if (maxlength) { %>
          maxlength="<%= maxlength %>"
        <% } %>

        <% if (tabindex) { %>
          tabindex="<%= tabindex %>"
        <% } %>

        <% if (inputMode) { %>
          inputMode="<%= inputMode %>"
        <% } %>

        <% if (form) { %>
          form="<%= form %>"
        <% } %>

        <% if (autocomplete) { %>
          autocomplete="<%= autocomplete %>"
        <% } %>

        <%- inputAttrs %>

        <%- extraAttrs %>
      >
    <% } %>

    <% if (hasPasswordEye) { %>
      <%- require('../password-btn/template.ejs')() %>
    <% } %>
  </span>

  <span class="<%= labelClasses %>">
    <%= label.text %>
  </span>

  <% if (isShowError) { %>
    <span
      class="form-error"
      data-js-form-error-msg="<%= isShowError %>"
    >
      <%= isShowError %>
    </span>
  <% } %>
</label>
